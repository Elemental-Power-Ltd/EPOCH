{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Site Range",
  "type": "object",
  "properties": {
    "building": {
      "type": "object",
      "title": "Building",
      "properties": {
        "COMPONENT_IS_MANDATORY": {"$ref":  "#/definitions/isMandatory"},
        "scalar_heat_load": {"$ref": "#/definitions/paramRangeFloat", "title":  "Scalar Heat Load"},
        "scalar_electrical_load": {"$ref": "#/definitions/paramRangeFloat", "title":  "Scalar Electrical Load"},
        "fabric_intervention_index": {
          "type": "array",
          "items": {"type": "integer", "minimum": 0},
          "title": "Fabric Intervention Index"
        }
      },
      "required": ["COMPONENT_IS_MANDATORY", "scalar_heat_load", "scalar_electrical_load", "fabric_intervention_index"]
    },
    "data_centre": {
      "type": "object",
      "title": "Data Centre",
      "properties": {
        "COMPONENT_IS_MANDATORY": {"$ref":  "#/definitions/isMandatory"},
        "maximum_load": {"$ref": "#/definitions/paramRangeFloat", "title":  "Maximum Load"},
        "hotroom_temp": {"$ref": "#/definitions/paramRangeFloat", "title": "Hotroom Temperature"}
      },
      "required": ["COMPONENT_IS_MANDATORY","maximum_load", "hotroom_temp"]
    },
    "domestic_hot_water": {
      "type": "object",
      "title": "Domestic Hot Water",
      "properties": {
        "COMPONENT_IS_MANDATORY": {"$ref":  "#/definitions/isMandatory"},
        "cylinder_volume": {"$ref": "#/definitions/paramRangeFloat", "title": "Cylinder Volume"}
      },
      "required": ["COMPONENT_IS_MANDATORY","cylinder_volume"]
    },
    "electric_vehicles": {
      "type": "object",
      "title": "EV Chargers",
      "properties": {
        "COMPONENT_IS_MANDATORY": {"$ref":  "#/definitions/isMandatory"},
        "flexible_load_ratio": {"$ref": "#/definitions/paramRangeFloat", "title":  "Flexible Load Ratio"},
        "small_chargers": {"$ref": "#/definitions/paramRangeInt", "title":  "Small Chargers"},
        "fast_chargers": {"$ref": "#/definitions/paramRangeInt", "title":  "Fast Chargers"},
        "rapid_chargers": {"$ref": "#/definitions/paramRangeInt", "title": "Rapid Chargers"},
        "ultra_chargers": {"$ref": "#/definitions/paramRangeInt", "title":  "Ultra Chargers"},
        "scalar_electrical_load": {"$ref": "#/definitions/paramRangeFloat", "title": "Scalar Electrical Load"}
      },
      "required": [
        "COMPONENT_IS_MANDATORY",
        "flexible_load_ratio",
        "small_chargers",
        "fast_chargers",
        "rapid_chargers",
        "ultra_chargers",
        "scalar_electrical_load"
      ]
    },
    "energy_storage_system": {
      "type": "object",
      "title": "Energy Storage System",
      "properties": {
        "COMPONENT_IS_MANDATORY": {"$ref":  "#/definitions/isMandatory"},
        "capacity": {"$ref": "#/definitions/paramRangeFloat", "title": "Capacity"},
        "charge_power": {"$ref": "#/definitions/paramRangeFloat", "title":  "Charge Power"},
        "discharge_power": {"$ref": "#/definitions/paramRangeFloat", "title":  "Discharge Power"},
        "battery_mode": {
          "type": "array",
          "items": {"type": "string", "enum": ["CONSUME", "CONSUME_PLUS"]},
          "title": "Battery Mode"
        },
        "initial_charge": {"$ref": "#/definitions/paramRangeFloat", "title":  "Initial Charge"}
      },
      "required": [
        "COMPONENT_IS_MANDATORY",
        "capacity",
        "charge_power",
        "discharge_power",
        "battery_mode",
        "initial_charge"
      ]
    },
    "gas_heater": {
      "type": "object",
      "title": "Gas Heater",
      "properties": {
        "COMPONENT_IS_MANDATORY": {"$ref":  "#/definitions/isMandatory"},
        "maximum_output": {"$ref": "#/definitions/paramRangeFloat", "title": "Maximum Output"},
        "gas_type": {
          "type": "array",
          "items": {"type": "string", "enum": ["NATURAL_GAS", "LIQUID_PETROLEUM_GAS"]},
          "title": "Gas Type"
        },
        "boiler_efficiency": {"$ref": "#/definitions/paramRangeFloat", "title": "Boiler Efficiency"}
      }
    },
    "grid": {
      "type": "object",
      "title": "Grid",
      "properties": {
        "COMPONENT_IS_MANDATORY": {"$ref":  "#/definitions/isMandatory"},
        "grid_export": {"$ref": "#/definitions/paramRangeFloat", "title": "Grid Export"},
        "grid_import": {"$ref": "#/definitions/paramRangeFloat", "title": "Grid Import"},
        "import_headroom": {"$ref": "#/definitions/paramRangeFloat", "title": "Import Headroom"},
        "tariff_index": {
          "type": "array",
          "items": {"type": "integer", "minimum": 0},
          "title": "Tariff Index"
        },
        "export_tariff": {"$ref":  "#/definitions/paramRangeFloat", "title":  "Export Tariff"}
      },
      "required": [
        "COMPONENT_IS_MANDATORY",
        "grid_export",
        "grid_import",
        "import_headroom",
        "tariff_index"
      ]
    },
    "heat_pump": {
      "type": "object",
      "title": "Heat Pump",
      "properties": {
        "COMPONENT_IS_MANDATORY": {"$ref":  "#/definitions/isMandatory"},
        "heat_power": {"$ref": "#/definitions/paramRangeFloat", "title":  "Heat Power"},
        "heat_source": {
          "type": "array",
          "items": {"type": "string", "enum": ["AMBIENT_AIR", "HOTROOM"]},
          "title": "Heat Source"
        },
        "send_temp": {"$ref": "#/definitions/paramRangeFloat", "title": "Send Temperature"}
      },
      "required": ["COMPONENT_IS_MANDATORY","heat_power", "heat_source", "send_temp"]
    },
    "mop": {
      "type": "object",
      "title": "Mop",
      "properties": {
        "COMPONENT_IS_MANDATORY": {"$ref":  "#/definitions/isMandatory"},
        "maximum_load": {"$ref": "#/definitions/paramRangeFloat", "title": "Maximum Load"}
      },
      "required": ["COMPONENT_IS_MANDATORY", "maximum_load"]
    },
    "renewables": {
      "type": "object",
      "title": "Renewables",
      "properties": {
        "COMPONENT_IS_MANDATORY": {"$ref":  "#/definitions/isMandatory"},
        "yield_scalars": {
          "type": "array",
          "items": {"$ref": "#/definitions/paramRangeFloat"},
          "title": "Yield Scalars"
        }
      },
      "required": ["COMPONENT_IS_MANDATORY", "yield_scalars"]
    },
    "config": {
      "type": "object",
      "title": "Config",
      "properties": {
        "capex_limit": {
          "type": "number",
          "title": "CAPEX Limit",
          "description": "The maximum capital expenditure (CAPEX) allowed at this site in pounds.",
          "minimum": 0,
          "default": 2500000
        },
        "use_boiler_upgrade_scheme": {
          "type": "boolean",
          "title": "Use Boiler Upgrade Scheme",
          "description": "Apply funding from the boiler upgrade scheme (if eligible).",
          "default": false
        },
        "general_grant_funding": {
          "type": "number",
          "title": "General Grant Funding",
          "description": "Apply unconditional funding up to this value in Â£.",
          "minimum": 0,
          "default": 0
        }
      },
      "required": ["capex_limit", "use_boiler_upgrade_scheme", "general_grant_funding"]
    }
  },
  "required": ["config"],

  "definitions": {
    "paramRangeInt": {
      "type": "object",
      "properties": {
        "min": {"type": "integer", "title": "Min"},
        "max": {"type": "integer", "title": "Max"},
        "step": {"type": "integer", "title": "Step"}
      },
      "required": ["min", "max", "step"]
    },
    "paramRangeFloat": {
      "type": "object",
      "properties": {
        "min": {"type": "number", "title": "Min"},
        "max": {"type": "number", "title": "Max"},
        "step": {"type": "number", "title": "Step"}
      },
      "required": ["min", "max", "step"]
    },
    "isMandatory": {
      "type": "boolean",
      "title": "Mandatory Component"
    }
  }
}